<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (19) on Tue Feb 04 17:34:25 CET 2025 -->
<title>Setup</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf8">
<meta name="dc.created" content="2025-02-04">
<meta name="description" content="declaration: package: acdp.tools, class: Setup">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../script.js"></script>
<script type="text/javascript" src="../../script-dir/jquery-3.6.0.min.js"></script>
<script type="text/javascript" src="../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/Setup.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../index-files/index-1.html">Index</a></li>
<li><a href="../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li><a href="#nested-class-summary">Nested</a></li>
<li>Field</li>
<li>Constr</li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li>Field</li>
<li>Constr</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li><a href="#nested-class-summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">acdp.tools</a></div>
<h1 title="Class Setup" class="title">Class Setup</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">acdp.tools.Setup</div>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="type-signature"><span class="modifiers">public final class </span><span class="element-name type-name-label">Setup</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
<div class="block">Assists with setting up a database once the concrete custom database class,
 the concrete custom table classes and the optional custom column types have
 been coded.
 All generated files, among them the database's layout file, are saved into a
 single directory.
 As a side effect, the Setup Tool checks the coded classes for correctness
 and writes a meaningful message to the <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/System.html#out" title="class or interface in java.lang" class="external-link">standard output
 stream</a> in the case of an error.
 <p>
 The Setup Tool needs as input the name of the <em>database class</em>, that
 is, a concrete subclass of the <a href="../design/CustomDatabase.html" title="class in acdp.design"><code>CustomDatabase</code></a> class.
 In order for the Setup Tool to be able to process the database class, the
 database class and the table classes must be annotated as described in
 the descriptions of the <code>CustomDatabase</code> and the <a href="../design/CustomTable.html" title="class in acdp.design"><code>CustomTable</code></a>
 classes.
 Needless to say that such annotations are only required for setting up the
 database.
 They can be removed once the database is setup.
 <p>
 Although the generated database layout, containing the nested layouts of the
 tables and columns, is complete and can be immediately used to open the
 database, you may want to manually customize it to suit your personal needs,
 for example for adding some comments (comment lines in a <a href="../misc/Layout.html" title="class in acdp.misc">layout</a> begin with the number sign ('#') character), for
 renaming or relocating the generated backing files of the database or for
 reducing the values of the table-specific settings <code>nobsRowRef</code>,
 <code>nobsOutrowPtr</code> and <code>nobsRefCount</code> to get a more compact storage
 format.
 (For an explanation of these fields read chapter "Explanation of the <code>
 nobsRowRef</code>, <code>nobsOutrowPtr</code> and <code>nobsRefCount</code> Settings" at
 the bottom.)
 Of course, all this can also be done later when some data has made its way
 into the database, but then no longer manually because there is a risk of
 data integrity violation.
 Use the methods defined in the <a href="Settings.html" title="class in acdp.tools"><code>Settings</code></a> class to view all database
 settings stored in the layout file and to modify some of them or <a href="Refactor.html" title="class in acdp.tools">refactor</a> the database to safely change the structure of the
 database.
 <p>
 If a table has a custom column type (contrary to a built-in column type)
 then its <a href="../design/SimpleType.TypeFromDesc.html" title="annotation in acdp.design">annotated</a> type factory method
 is assumed to be a member of the class defining that custom column type.
 If this is not the case then please change the value of the <code>
 typeFactoryClassName</code> field of the corresponding column sublayout
 accordingly.
 On this occasion, you may want to add the <code>typeFactoryClasspath</code> field
 in that  column sublayout with a value equal to the directory housing the
 class file of the class that defines the type factory class method and any
 depending class files.
 Of course, this is only necessary if those class files are not yet on
 the classpath which may be the case if the database is opened as a
 <a href="../Database.html" title="interface in acdp">weakly typed database</a>.
 (You can also put your class files inside a JAR file and save it into the
 directory specified by the <code>typeFactoryClasspath</code> layout field or into
 any subdirectory of this directory.)
 <p>
 When running the Setup Tool it is not necessary to specify whether the data
 in the database should be encrypted or not.
 As long as the database is empty, or as soon as it is empty again, the type
 of encryption can be defined (or redefined) when opening the empty database.
 <p>
 The Setup Tool can be run from the <a href="#main(java.lang.String%5B%5D)"><code>main(java.lang.String[])</code></a> method or by invoking the
 <a href="#run(java.lang.String,java.nio.file.Path)"><code>run(java.lang.String, java.nio.file.Path)</code></a> method.
 
 <h2>Explanation of the <code>nobsRowRef</code>, <code>nobsOutrowPtr</code> and <code>
 nobsRefCount</code> Settings</h2>
 Each table is roughly sized by the values of the following three parameters
 which appear in the <code>store</code> section of the table layout: The <code>
 nobsRowRef</code>, <code>nobsOutrowPtr</code> and <code>nobsRefCount</code> parameters.
 (The abbreviation <code>nobs</code> stands for "number of bytes".)
 
 <h3><code>nobsRowRef</code></h3>
 The value of the <code>nobsRowRef</code> parameter limits the number of rows in
 the table to 256<sup><code>nobsRowRef</code></sup> - 1, e.g., 65535 if <code>
 nobsRowRef</code> is equal to 2.
 The value of <code>nobsRowRef</code> cannot be greater than 8 and if it is 8 then
 the size of the table is limited to the absolute maximum of <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html#MAX_VALUE" title="class or interface in java.lang" class="external-link"><code>Long.MAX_VALUE</code></a> &asymp; 9&sdot;10<sup>18</sup> rows.
 (In practice, this is not a limitation if we keep in mind that a file cannot
 be larger than <code>Long.MAX_VALUE</code> bytes.)
 The size of the byte representation of a <a href="../Ref.html" title="interface in acdp">reference</a> is
 identical to the value of this parameter.
 
 <h3><code>nobsOutrowPtr</code></h3>
 Table data from columns with an <a href="../types/Type.Scheme.html#OUTROW">outrow</a> storage
 scheme or being of an <a href="../types/Type.Scheme.html#INROW">inrow</a>  array type having an
 outrow element type is stored in a separate file, the so called "VL data
 file".
 Outrow data is referenced by a <em>file position</em> that locates the start
 of the outrow data within the VL data file.
 The file position is an unsigned integer of length equal to the value of the
 <code>nobsOutrowPtr</code> parameter thus limiting the size of the VL data file
 by the size of all blocks with a file position less than
 256<sup><code>nobsOutrowPtr</code></sup> - 1.
 As with the <code>nobsRowRef</code> parameter, the value of <code>nobsOutrowPtr</code>
 cannot be greater than 8 and if it is 8 then the size of the file storing
 the outrow data of the table is limited to the absolute maximum of <code>
 Long.MAX_VALUE</code> bytes which is around eight million terabytes.
 This parameter is missing if the table doesn't store any outrow data.
 
 <h3><code>nobsRefCount</code></h3>
 The value of the <code>nobsRefCount</code> parameter limits the number of rows
 that can reference a particular row within the table to
 256<sup><code>nobsRefCount</code></sup>-1, e.g., 255 if <code>nobsRefCount</code> is
 equal to 1.
 As with the other two fields, the value of <code>nobsRefCount</code> cannot be
 greater than 8 and if it is 8 then the number of rows referencing a
 particular row within the table is limited to the absolute maximum of <code>
 Long.MAX_VALUE</code> &asymp; 9&sdot;10<sup>18</sup> rows.
 This parameter is missing if none of the tables of the database (including
 this table) has a column referencing this table.
 <p>
 The Setup Tool sets these three parameters to their maximum value of 8.
 As long as the table is empty you can reduce these values by simply editing
 the database layout file manually, but with one exception concerning the
 <code>nobsRowRef</code> parameter of a table referenced by other tables, because
 changing this parameter changes the size of the byte representation of a
 reference, which may change the length of the referencing column and thus the
 length of the row of the referencing table.
 However, this is not a problem if the referencing tables are empty.
 Anyway, to be on the safe side, these values should to be changed by
 refactoring the database, hence, by invoking one of the following three
 methods: <a href="Refactor.html#nobsRowRef(java.nio.file.Path,java.lang.String,int)"><code>Refactor.nobsRowRef(java.nio.file.Path, java.lang.String, int)</code></a>, <a href="Refactor.html#nobsOutrowPtr(java.nio.file.Path,java.lang.String,int)"><code>Refactor.nobsOutrowPtr(java.nio.file.Path, java.lang.String, int)</code></a>, and
 <a href="Refactor.html#nobsRefCount(java.nio.file.Path,java.lang.String,int)"><code>Refactor.nobsRefCount(java.nio.file.Path, java.lang.String, int)</code></a>.
 Note that if these values are reduced too much, the risk increases that the
 corresponding maximum values described above are exceeded.
 ACDP throws a <a href="../exceptions/MaximumException.html" title="class in acdp.exceptions"><code>MaximumException</code></a> if the maximum
 values determined by these parameters are to be exceeded.</div>
<dl class="notes">
<dt>Author:</dt>
<dd>Beat Hörmann</dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li>
<section class="nested-class-summary" id="nested-class-summary">
<h2>Nested Class Summary</h2>
<div class="caption"><span>Nested Classes</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Class</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static @interface&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="Setup.SetupColumn.html" class="type-name-link" title="annotation in acdp.tools">Setup.SetupColumn</a></code></div>
<div class="col-last even-row-color">
<div class="block">The <code>@SetupColumn</code> annotation is used by the Setup Tool to
 identify the column <em>objects</em> declared within a table class.</div>
</div>
<div class="col-first odd-row-color"><code>static @interface&nbsp;</code></div>
<div class="col-second odd-row-color"><code><a href="Setup.SetupDatabase.html" class="type-name-link" title="annotation in acdp.tools">Setup.SetupDatabase</a></code></div>
<div class="col-last odd-row-color">
<div class="block">The <code>@SetupDatabase</code> annotation is used by the Setup Tool to get
 the name of the database and the names of the database's tables.</div>
</div>
<div class="col-first even-row-color"><code>static @interface&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="Setup.SetupTable.html" class="type-name-link" title="annotation in acdp.tools">Setup.SetupTable</a></code></div>
<div class="col-last even-row-color">
<div class="block">The <code>@SetupTable</code> annotation is used by the Setup Tool to get the
 names of the table's columns.</div>
</div>
<div class="col-first odd-row-color"><code>static @interface&nbsp;</code></div>
<div class="col-second odd-row-color"><code><a href="Setup.SetupTableDeclaration.html" class="type-name-link" title="annotation in acdp.tools">Setup.SetupTableDeclaration</a></code></div>
<div class="col-last odd-row-color">
<div class="block">The <code>@SetupTableDeclaration</code> annotation is used by the Setup Tool
 to identify a table declaration within the database class.</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab1" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab1', 3)" class="table-tab">Static Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static final void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#main(java.lang.String%5B%5D)" class="member-name-link">main</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]&nbsp;args)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">The <code>main</code> method invoking the <a href="#run(java.lang.String,java.nio.file.Path)"><code>run(java.lang.String, java.nio.file.Path)</code></a> method.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static final void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#run(java.lang.String,java.nio.file.Path)" class="member-name-link">run</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;dbcn,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/nio/file/Path.html" title="class or interface in java.nio.file" class="external-link">Path</a>&nbsp;dir)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Generates the database files from a database class, hence, from a class
 annotated with the <a href="Setup.SetupDatabase.html" title="annotation in acdp.tools"><code>@SetupDatabase</code></a> annotation and
 saves them to a given directory.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="run(java.lang.String,java.nio.file.Path)">
<h3>run</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">run</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;dbcn,
 <a href="https://docs.oracle.com/javase/8/docs/api/java/nio/file/Path.html" title="class or interface in java.nio.file" class="external-link">Path</a>&nbsp;dir)</span>
                      throws <span class="exceptions"><a href="../exceptions/IOFailureException.html" title="class in acdp.exceptions">IOFailureException</a></span></div>
<div class="block">Generates the database files from a database class, hence, from a class
 annotated with the <a href="Setup.SetupDatabase.html" title="annotation in acdp.tools"><code>@SetupDatabase</code></a> annotation and
 saves them to a given directory.
 <p>
 This method may throw an exception that is different from the listed
 exception.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>dbcn</code> - The name of the database class, for instance
         "<code>com.example.MyDB</code>".
         The database class is the class annotated with <a href="Setup.SetupDatabase.html" title="annotation in acdp.tools"><code>@SetupDatabase</code></a>.</dd>
<dd><code>dir</code> - The directory where the generated database files are to be
         saved.
         If this value is <code>null</code> then this method takes as directory
         the value returned by a call to <code>Paths.get(dbName)</code> where
         <code>dbName</code> denotes the name of the database.</dd>
<dt>Throws:</dt>
<dd><code><a href="../exceptions/IOFailureException.html" title="class in acdp.exceptions">IOFailureException</a></code> - If saving the genereated database files fails.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="main(java.lang.String[])">
<h3>main</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">main</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]&nbsp;args)</span>
                       throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a>,
<a href="../exceptions/IOFailureException.html" title="class in acdp.exceptions">IOFailureException</a></span></div>
<div class="block">The <code>main</code> method invoking the <a href="#run(java.lang.String,java.nio.file.Path)"><code>run(java.lang.String, java.nio.file.Path)</code></a> method.
 <p>
 The first element of the <code>args</code> array must contain the name of the
 database class, for instance "<code>com.example.MyDB</code>".
 If the <code>args</code> array contains a second element then this element is
 assumed to denote the directory where to save the generated database
 files.
 If the <code>args</code> array does not contain a second element then the
 generated database files are saved to the directory obtained by a call
 to <code>Paths.get(dbName)</code> where <code>dbName</code> denotes the name of
 the database.
 <p>
 This method may throw an exception that is different from the listed
 exceptions.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>args</code> - The command-line arguments.
         See the method description for details.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - If <code>args</code> is empty or contains
         more than two elements.</dd>
<dd><code><a href="../exceptions/IOFailureException.html" title="class in acdp.exceptions">IOFailureException</a></code> - If saving the genereated database files fails.</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
