<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="de">
<head>
<!-- Generated by javadoc (11) on Wed Nov 18 15:41:38 CET 2020 -->
<title>Unit</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf8">
<meta name="dc.created" content="2020-11-18">
<link rel="stylesheet" type="text/css" href="../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../jquery/jquery-ui.css" title="Style">
<script type="text/javascript" src="../script.js"></script>
<script type="text/javascript" src="../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../jquery/jquery-3.3.1.js"></script>
<script type="text/javascript" src="../jquery/jquery-migrate-3.0.1.js"></script>
<script type="text/javascript" src="../jquery/jquery-ui.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="Unit";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":6,"i1":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../";
var useModuleDirectories = false;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/Unit.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-files/index-1.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">acdp</a></div>
<h2 title="Interface Unit" class="title">Interface Unit</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Superinterfaces:</dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/AutoCloseable.html?is-external=true" title="class or interface in java.lang" class="externalLink">AutoCloseable</a></code></dd>
</dl>
<hr>
<pre>public interface <span class="typeNameLabel">Unit</span>
extends <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/AutoCloseable.html?is-external=true" title="class or interface in java.lang" class="externalLink">AutoCloseable</a></pre>
<div class="block">Confines an atomically executed sequence of read/write database operations
 that has to be committed or otherwise undone.
 <p>
 Users are strongly encouraged to apply the following usage pattern:
 
 <pre>
 // db of type Database or CustomDatabase, not null.
 // Precondition: db.info().isWritable()
 try (Unit u = db.openUnit()) {
    ...
    u.commit();
 }</pre>
 
 where the ellipsis ('&hellip;') stands for any program code, including code
 that contains calls to <code>u.commit()</code> and code that repeats this usage
 pattern to create one or more <em>nested</em> units.
 <p>
 The effects of so called <em>unconfirmed</em> write operations (see below)
 onto the data persisted in the database are reverted at the time a unit is
 closed.
 Those unconfirmed write operations are said to be <em>rolled back</em>.
 <p>
 To explain what an "unconfirmed write operation" is, we need to introduce
 some additional concepts.
 <p>
 A write operation that is executed within a unit <code>u</code> but not within a
 nested unit in <code>u</code> is said to be a "write operation of <code>u</code>".
 A write operation <code>w</code> of <code>u</code> is <em>committed</em> in <code>u</code>
 as soon as <code>u.commit()</code> is successfully executed for the first time
 since the termination of <code>w</code>.
 As long as <code>w</code> is not committed it is said to be <em>uncommitted</em>.
 Likewise, a nested unit in <code>u</code> is <em>committed</em> in <code>u</code> as
 soon as <code>u.commit()</code> is successfully executed for the first time since
 that nested unit was closed.
 As long as the nested unit is not committed it is said to be
 <em>uncommitted</em>.
 Note that the nested units in <code>u</code> include <em>deeply nested units</em>,
 for example, a unit <code>u''</code> that is in a unit <code>u'</code> thas is in
 <code>u</code>.
 <p>
 Now, an <em>unconfirmed write operation</em> is either an uncommitted write
 operation of <code>u</code> <em>or</em> a committed write operation of an
 uncommitted nested unit in <code>u</code>.
 <p>
 In the following examples <code>w</code> denotes a write operation and <code>c</code>
 denotes the successful execution of the <a href="#commit()"><code>commit()</code></a> method.
 Unconfirmed write operations are marked with an asterisk ('<code>*</code>').
 Nested units in <code>u</code> are indented and labeled with <code>u'</code> and <code>
 u''</code>.
 
 <pre>
 Example 1          Example 2           Example 3
 
 u  u' u''          u  u' u''           u  u' u''
 
 w1                 w1*                 w1
 w2                    w1.1*               w1.1
    w1.1                  w1.1.1              w1.1.1
    c                  c                      c
 w3                                           w1.1.2
 c                                      c
    w2.1*
       w1.1.1*
       c
    w2.2*
    c
 w4*</pre>
 
 In the first example the write operations <code>w2.1</code>, <code>w1.1.1</code>,
 <code>w2.2</code> and <code>w4</code> are unconfirmed because the first three ones are
 committed write operations of nested units that are uncommitted in <code>u</code>
 and the last is an uncommitted write operation of <code>u</code>.
 In the second example the write operations <code>w1</code> and <code>w1.1</code> are
 unconfirmed.
 (The write operation <code>w1.1.1</code> was rolled back at the time <code>u''</code>
 was closed because it was an uncommitted write operation of <code>u''</code>.)
 In the third example there is no unconfirmed write operation:
 The write operations <code>w1.1</code>, <code>w1.1.1</code> and <code>w1.1.2</code> were
 rolled back before and <code>w1</code> is a committed write operation of <code>
 u</code>.
 Note that the write operation <code>w1.1.1</code> was rolled back at the time
 <code>u'</code> was closed because <code>u''</code> remained uncommitted in <code>u'</code>.
 Write operation <code>w1.1.1</code> was not rolled back at the time <code>u''</code>
 was closed because <code>w1.1.1</code> was committed in <code>u''</code>.
 However, write operation <code>w1.1.2</code> was rolled back at the time <code>
 u''</code> was closed because it remained uncommitted in <code>u''</code>.
 <p>
 Units only make sense if the database is <a href="Information.DatabaseInfo.html#isWritable()">writable</a>.
 
 <h1>Broken Unit</h1>
 A unit <em>breaks</em> if one of the methods specified in this interface
 breaks the unit or if a write operation invoked within the unit fails
 recording its before data.
 <p>
 A unit that is about to break throws a <code>UnitBrokenException</code>.
 In case of a disaster, for instance a power failure or a crash of the
 storage device, a unit may not have a chance to throw a <code>
 UnitBrokenException</code>.
 <p>
 If a unit breaks, ACDP tries to rollback any unconfirmed write operations.
 However, even if the unconfirmed write operations can successfully be rolled
 back, the unit remains broken and units can no longer be executed.
 <p>
 <em>The only way to recover from a broken unit is to close the database
 and open the database again.</em>
 <p>
 Do the following if a unit is broken:
 
 <ol>
    <li>Close the database.</li>
    <li>Check the integrity of the persisted data by calling the <a href="misc/ACDP.html#verify(java.nio.file.Path,boolean,boolean)"><code>ACDP.verify(java.nio.file.Path, boolean, boolean)</code></a> method.</li>
    <li>Find out if recent changes made to the database have been
    materialized, in particular, check if <code>forceWriteCommit</code> (see
    section "Durability" in the description of the <a href="Database.html" title="interface in acdp"><code>Database</code></a>
    interface) was enabled and analyze the <em>recorder file</em>.
    (The recorder file is the place where ACDP saves any before data of
    unconfirmed write operations.
    The path to the recorder file is saved in the <code>recFile</code> entry of
    the database layout.)
    <li>Repair the database if necessary.</li>
    <li>Reopen the database.</li>
 </ol>
 <p>
 Reopening the database may rollback any unconfirmed write operations and thus
 healing a broken unit, however, rolling back fails if the recorder file is
 corrupted.
 If this is the case then repair the recorder file and try to open the
 database again.
 <p>
 Note that ACDP never "automatically" rolls back a unit with the exception of
 the situation described above.
 (The database has to be writable.
 If the database is a write protected WR database then ACDP still detects an
 earlier produced broken unit or a corrupted recorder file but ACDP does not
 execute a rollback.)
 <p>
 ACDP makes an effort to avoid rollbacks based on a recorder file that is, in
 reality, corrupted but which ACDP naively could believe being non-corrupted.
 <p>
 There should be no need for clients to implement this interface.</div>
<dl>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>Beat Hörmann</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#close()">close</a></span>()</code></th>
<td class="colLast">
<div class="block">Rolls back any uncommitted write operations of this unit as well as any
 write operations that were executed and committed in any uncommitted
 nested units and closes this unit.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#commit()">commit</a></span>()</code></th>
<td class="colLast">
<div class="block">Commits any yet uncommitted write operations of this unit as well as any
 yet uncommitted nested units in this unit.</div>
</td>
</tr>
</table>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="commit()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>commit</h4>
<pre class="methodSignature">void&nbsp;commit()
     throws <a href="exceptions/ACDPException.html" title="class in acdp.exceptions">ACDPException</a>,
            <a href="exceptions/UnitBrokenException.html" title="class in acdp.exceptions">UnitBrokenException</a></pre>
<div class="block">Commits any yet uncommitted write operations of this unit as well as any
 yet uncommitted nested units in this unit.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="exceptions/ACDPException.html" title="class in acdp.exceptions">ACDPException</a></code> - If this unit was originally opened in a thread
         different from the current thread.
         This exception never happens if you consequently apply the usage
         pattern described in the class description.</dd>
<dd><code><a href="exceptions/UnitBrokenException.html" title="class in acdp.exceptions">UnitBrokenException</a></code> - If committing fails, including the case that
         this unit was already broken before this method was able to start
         doing its job.</dd>
</dl>
</li>
</ul>
<a id="close()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>close</h4>
<pre class="methodSignature">void&nbsp;close()
    throws <a href="exceptions/ACDPException.html" title="class in acdp.exceptions">ACDPException</a>,
           <a href="exceptions/UnitBrokenException.html" title="class in acdp.exceptions">UnitBrokenException</a></pre>
<div class="block">Rolls back any uncommitted write operations of this unit as well as any
 write operations that were executed and committed in any uncommitted
 nested units and closes this unit.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/AutoCloseable.html?is-external=true#close()" title="class or interface in java.lang" class="externalLink">close</a></code>&nbsp;in interface&nbsp;<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/AutoCloseable.html?is-external=true" title="class or interface in java.lang" class="externalLink">AutoCloseable</a></code></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="exceptions/ACDPException.html" title="class in acdp.exceptions">ACDPException</a></code> - If this unit was originally opened in a thread
         different from the current thread or if this unit contains an
         open read zone.
         This exception never happens if you consequently apply the usage
         pattern described in the description of this interface and if you
         consequently close inside a unit any read zone that was opened
         within that unit.</dd>
<dd><code><a href="exceptions/UnitBrokenException.html" title="class in acdp.exceptions">UnitBrokenException</a></code> - If this unit was already broken before this
         method was invoked or if rolling back any uncommitted write
         operations failed.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/Unit.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-files/index-1.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
</footer>
</body>
</html>
